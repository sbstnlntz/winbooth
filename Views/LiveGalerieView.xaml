<UserControl x:Class="FotoboxApp.Views.LiveGalerieView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{StaticResource FB_BackgroundBrush}">
    <Grid>
        <!-- Hauptebene: Galerie und Schließen-Button -->
        <DockPanel>
            <Button x:Name="CloseButton"
                    Content="X"
                    DockPanel.Dock="Top"
                    Width="70" Height="70"
                    FontSize="34"
                    FontWeight="Bold"
                    Background="#D93030"
                    Foreground="White"
                    BorderBrush="#B02020"
                    BorderThickness="2"
                    Margin="10"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Cursor="Hand"
                    Click="CloseButton_Click"/>
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                          Background="{StaticResource FB_BackgroundBrush}">
                <ScrollViewer.Resources>
                    <Style TargetType="ScrollBar">
                        <Setter Property="Opacity" Value="0"/>
                        <Setter Property="Width" Value="0"/>
                    </Style>
                </ScrollViewer.Resources>
                <ItemsControl x:Name="GalleryItems">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=ScrollViewer}}" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Margin="10"
                                    Padding="8"
                                    CornerRadius="14"
                                    Background="#33000000">
                                <Grid Width="220" Height="160" ClipToBounds="True">
                                    <Border Background="#22000000" CornerRadius="10"/>
                                    <Image Source="{Binding}"
                                           Stretch="Uniform"
                                           SnapsToDevicePixels="True"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Cursor="Hand"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </DockPanel>

        <!-- MODAL-OVERLAY: Immer GANZ OBEN (letztes Kind im Grid!) -->
        <Grid x:Name="ModalOverlay"

              Background="{StaticResource FB_OverlayBrush}"

              Visibility="Collapsed"

              HorizontalAlignment="Stretch"

              VerticalAlignment="Stretch"

              Focusable="True"

              IsManipulationEnabled="True"

              PreviewKeyDown="ModalOverlay_PreviewKeyDown"

              ManipulationCompleted="ModalOverlay_ManipulationCompleted"

              Panel.ZIndex="1000">

            <Grid.ColumnDefinitions>

                <ColumnDefinition Width="Auto"/>

                <ColumnDefinition Width="*"/>

                <ColumnDefinition Width="Auto"/>

            </Grid.ColumnDefinitions>



            <Button x:Name="PreviousButton"

                    Grid.Column="0"

                    Content="‹"

                    Width="120"

                    Height="120"

                    FontSize="48"

                    Background="#AA000000"

                    Foreground="White"

                    BorderBrush="#66000000"

                    BorderThickness="2"

                    Margin="20"

                    Click="PreviousButton_Click"

                    Cursor="Hand"/>



            <Border Grid.Column="1"

                    HorizontalAlignment="Center"

                    VerticalAlignment="Center"

                    Padding="24">

                <Image x:Name="ModalImage"

                       Stretch="Uniform"

                       VerticalAlignment="Center"

                       HorizontalAlignment="Center"

                       MaxHeight="900"

                       MaxWidth="1600"/>

            </Border>



            <Button x:Name="NextButton"

                    Grid.Column="2"

                    Content="›"

                    Width="120"

                    Height="120"

                    FontSize="48"

                    Background="#AA000000"

                    Foreground="White"

                    BorderBrush="#66000000"

                    BorderThickness="2"

                    Margin="20"

                    Click="NextButton_Click"

                    Cursor="Hand"/>



            <Button x:Name="ModalCloseButton"

                    Grid.ColumnSpan="3"

                    Content="X"

                    Width="80" Height="80"

                    FontSize="32"

                    FontWeight="Bold"

                    Background="#D93030"

                    Foreground="White"

                    BorderBrush="#B02020"

                    BorderThickness="2"

                    HorizontalAlignment="Right"

                    VerticalAlignment="Top"

                    Margin="32"

                    Cursor="Hand"

                    Click="ModalClose_Click"/>

        </Grid>
    </Grid>
</UserControl>
